{% extends "internal.html" %}
{% block content %}
{% include "partials/_group_display.html" %}
<div class="relative z-10" aria-labelledby="modal-title" role="dialog" aria-modal="true"
  x-transition:enter="ease-out duration-100" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100"
  x-transition:leave="ease-in duration-100" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0"
  x-show="true">
  <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"></div>

  <div class="fixed inset-0 z-10 overflow-y-auto">
    <div class="flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0" [x-cloak]
      x-transition:enter="ease-out duration-300"
      x-transition:enter-start="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
      x-transition:enter-end="opacity-100 translate-y-0 sm:scale-100" x-transition:leave="ease-in duration-300"
      x-transition:leave-start="opacity-100 translate-y-0 sm:scale-100"
      x-transition:leave-end="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95" x-show="true">
      <form action="/groups/{{ group.id }}/goals/{{ goal.id }}/edit" method="POST"
        class="relative space-y-2 transform overflow-hidden rounded-lg bg-white px-4 pb-4 pt-5 space-y-2 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:p-6">
        {{ csrf_token|safe }}
        <h2 class="font-bold text-xl text-stone-900 mb-1">Edit Goal</h2>
        <div>
          <label for="title" class="block text-sm font-medium leading-6 text-gray-900">Title</label>
          <div class="mt-2">
            <input type="text" name="title" id="title"
              class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-violet-600 sm:text-sm sm:leading-6"
              value="{{ goal.title }}">
          </div>
        </div>
        <div>
          <label for="description" class="block text-sm font-medium leading-6 text-gray-900">Description</label>
          <div class="mt-2">
            <textarea rows="4" name="description" id="description"
              class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-violet-600 sm:text-sm sm:leading-6">{% if let Some(desc) = goal.description -%}{{ desc }}{% endif -%}</textarea>
          </div>
        </div>
        <div>
          <label class="text-base font-semibold text-gray-900">Stage</label>
          <fieldset class="mt-4">
            <legend class="sr-only">Stage</legend>
            <div class="gap-2 grid grid-cols-2 grid-rows-2">
              <!-- TODO: Darken selected option (alpine something something, checked meta class?) -->
              {% for stage in group.tone_stages %}
              <div class="flex items-center">
                <input id="stage{{ loop.index0 }}" name="stage" type="radio" {% if goal.stage|stage_loop_comp(loop.index0) %}
                  checked {% endif %} class="h-4 w-4 border-gray-300 text-violet-600 focus:ring-violet-600"
                  value="{{ loop.index0 }}">
                <label for="stage{{ loop.index0 }}"
                  class="ml-3 block text-sm font-medium leading-6 {{ loop.index0|stage_color }}  text-gray-50 px-4 py-1 rounded-full">{{
                  stage }}</label>
              </div>
              {% endfor %}
            </div>
          </fieldset>
          {% if let Some(deadline) = goal.deadline %}
          <div>
            <label for="deadline" class="block text-sm font-medium leading-6 text-gray-900">Deadline</label>
            <div class="mt-2">
              <input type="date" name="deadline" id="deadline"
                class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-violet-600 sm:text-sm sm:leading-6"
                value="{{ deadline }}"
                >
            </div>
          </div>
          {% endif %}
        </div>
        <div>
          <div class="mt-2 sm:mt-4 sm:flex sm:flex-row-reverse">
            <button type="submit"
              class="inline-flex w-full justify-center rounded-md bg-emerald-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-emerald-500 sm:ml-3 sm:w-auto">Save</button>
            <a href="/groups/{{ group.id }}"
              class="mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto">Cancel</a>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock content %}
